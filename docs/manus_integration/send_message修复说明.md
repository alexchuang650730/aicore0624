# ğŸ”§ send_message åŠŸèƒ½ä¿®å¤è¯¦è§£

## ğŸ“‹ ä¿®å¤å‰ vs ä¿®å¤åå¯¹æ¯”

### âŒ **ä¿®å¤å‰çš„é—®é¢˜**

#### 1. ç®€å•æ¨¡æ‹Ÿå‘é€
```python
# ä¿®å¤å‰çš„ä»£ç 
@app.route('/api/manus/send', methods=['POST'])
def send_to_manus():
    data = request.get_json()
    query = data.get('query', '')
    
    # åªæ˜¯ç®€å•çš„æ¨¡æ‹Ÿå‘é€
    result = f"å·²å‘é€queryåˆ°Manusé¡¹ç›®uxW8QshQ7aEAVOKIxHxoG5: {query}"
    
    return jsonify({
        'success': True,
        'message': 'Queryå·²å‘é€åˆ°Manuså¹³å°',
        'query': query,
        'result': result
    })
```

**é—®é¢˜**ï¼š
- âŒ åªæ˜¯ç®€å•è½¬å‘ï¼Œæ²¡æœ‰æ™ºèƒ½å¤„ç†
- âŒ ä¸æ£€æµ‹æŸ¥è¯¢ç±»å‹
- âŒ ä¸å¤„ç†ä»“åº“ä¿¡æ¯
- âŒ ä¸è¯·æ±‚git clone
- âŒ åŠŸèƒ½å•ä¸€ï¼Œç¼ºä¹å®ç”¨æ€§

---

### âœ… **ä¿®å¤åçš„åŠŸèƒ½**

#### 1. æ™ºèƒ½ä»“åº“æ£€æµ‹
```python
# æ£€æµ‹æ˜¯å¦ä¸ºä»“åº“ç›¸å…³æŸ¥è¯¢
repository_keywords = ['å€‰', 'ä»“åº“', 'æª”æ¡ˆ', 'æ–‡ä»¶', 'file', 'repository', 'repo', 'git']
is_repository_query = any(keyword in query.lower() for keyword in repository_keywords)
```

#### 2. è‡ªåŠ¨ä»“åº“ä¿¡æ¯å¢å¼º
```python
# å½“å‰ä»“åº“ä¿¡æ¯
current_repo = {
    'name': 'alexchuang650730/aicore0624',
    'url': 'https://github.com/alexchuang650730/aicore0624.git',
    'branch': 'main'
}

# å¢å¼ºquery
if is_repository_query:
    enhanced_query = f"{query} (ä»“åº“: {current_repo['name']}, åˆ†æ”¯: {current_repo['branch']})"
```

#### 3. æ™ºèƒ½git cloneè¯·æ±‚
```python
if is_repository_query:
    has_repo = False  # æ£€æŸ¥Manusæ˜¯å¦æœ‰è¿™ä¸ªä»“åº“
    
    if not has_repo:
        # æ„å»ºgit cloneè¯·æ±‚æ¶ˆæ¯
        git_clone_command = f"git clone {current_repo['url']}"
        manus_message = f"æŸ¥è¯¢: {enhanced_query}\n"
        manus_message += f"æ£€æµ‹åˆ°éœ€è¦ä»“åº“æ•°æ®ï¼Œä½†é¡¹ç›®ä¸­å°šæœªåŒ…å«ä»“åº“ {current_repo['name']}ã€‚\n"
        manus_message += f"è¯·æ‰§è¡Œ: {git_clone_command}\n"
        manus_message += f"ç„¶ååˆ†æä»“åº“æ–‡ä»¶æ•°é‡å¹¶å›åº”æŸ¥è¯¢ã€‚"
```

#### 4. å®Œæ•´çš„å“åº”æ•°æ®
```python
response_data = {
    'success': True,
    'message': 'Queryå·²å‘é€åˆ°Manuså¹³å°',
    'query': query,                           # åŸå§‹æŸ¥è¯¢
    'enhanced_query': enhanced_query,         # å¢å¼ºåçš„æŸ¥è¯¢
    'manus_message': manus_message,          # å‘é€ç»™Manusçš„å®Œæ•´æ¶ˆæ¯
    'result': result,                        # å¤„ç†ç»“æœ
    'repository_info': current_repo,         # ä»“åº“ä¿¡æ¯
    'git_clone_requested': True,             # æ˜¯å¦è¯·æ±‚äº†git clone
    'timestamp': datetime.now().isoformat()  # æ—¶é—´æˆ³
}
```

---

## ğŸ¯ **å…·ä½“åšäº†ä»€ä¹ˆ**

### 1. **æ™ºèƒ½æŸ¥è¯¢åˆ†æ**
- ğŸ” **æ£€æµ‹æŸ¥è¯¢ç±»å‹**ï¼šè‡ªåŠ¨è¯†åˆ«æ˜¯å¦ä¸ºä»“åº“ç›¸å…³æŸ¥è¯¢
- ğŸ“ **å…³é”®è¯åŒ¹é…**ï¼šæ£€æµ‹ä¸­è‹±æ–‡ä»“åº“å…³é”®è¯
- ğŸ¯ **ç²¾å‡†è¯†åˆ«**ï¼šåŒºåˆ†ä»“åº“æŸ¥è¯¢å’Œæ™®é€šæŸ¥è¯¢

### 2. **è‡ªåŠ¨ä¿¡æ¯å¢å¼º**
- ğŸ“‹ **ä»“åº“ä¿¡æ¯æ³¨å…¥**ï¼šè‡ªåŠ¨å°†å½“å‰ä»“åº“ä¿¡æ¯åŠ å…¥æŸ¥è¯¢
- ğŸ”— **å®Œæ•´ä¸Šä¸‹æ–‡**ï¼šæä¾›ä»“åº“åç§°ã€URLã€åˆ†æ”¯ä¿¡æ¯
- ğŸ“ˆ **æŸ¥è¯¢å¢å¼º**ï¼šä»ç®€å•æŸ¥è¯¢å˜ä¸ºåŒ…å«å®Œæ•´ä¸Šä¸‹æ–‡çš„æŸ¥è¯¢

### 3. **æ™ºèƒ½git cloneå¤„ç†**
- ğŸ” **ä»“åº“å­˜åœ¨æ£€æŸ¥**ï¼šæ£€æµ‹Manusé¡¹ç›®æ˜¯å¦å·²æœ‰ç›®æ ‡ä»“åº“
- ğŸ”„ **è‡ªåŠ¨å…‹éš†è¯·æ±‚**ï¼šå¦‚æœæ²¡æœ‰ä»“åº“ï¼Œè‡ªåŠ¨ç”Ÿæˆgit cloneæŒ‡ä»¤
- ğŸ“‹ **å®Œæ•´æŒ‡ä»¤**ï¼šç”ŸæˆåŒ…å«å…‹éš†å’Œåˆ†æä»»åŠ¡çš„å®Œæ•´æ¶ˆæ¯

### 4. **ç»Ÿä¸€APIé›†æˆ**
- ğŸ”— **åŒé‡å¤„ç†**ï¼šç»Ÿä¸€APIä¹Ÿä½¿ç”¨ç›¸åŒçš„æ™ºèƒ½å¤„ç†é€»è¾‘
- ğŸ“Š **ä¸€è‡´æ€§**ï¼šç¡®ä¿send_messageå’Œunified APIè¡Œä¸ºä¸€è‡´
- ğŸ¯ **ååŒå·¥ä½œ**ï¼šä¸¤ä¸ªAPIå…±äº«ç›¸åŒçš„ä»“åº“æ£€æµ‹å’Œå¤„ç†æœºåˆ¶

---

## ğŸš€ **å®é™…æ•ˆæœå±•ç¤º**

### è¾“å…¥æŸ¥è¯¢
```
"ç›®å‰çš„å€‰çš„æª”æ¡ˆæ•¸é‡æ˜¯å¤šå°‘"
```

### ä¿®å¤å‰è¾“å‡º
```json
{
  "success": true,
  "message": "Queryå·²å‘é€åˆ°Manuså¹³å°",
  "query": "ç›®å‰çš„å€‰çš„æª”æ¡ˆæ•¸é‡æ˜¯å¤šå°‘",
  "result": "å·²å‘é€queryåˆ°Manusé¡¹ç›®uxW8QshQ7aEAVOKIxHxoG5: ç›®å‰çš„å€‰çš„æª”æ¡ˆæ•¸é‡æ˜¯å¤šå°‘"
}
```

### ä¿®å¤åè¾“å‡º
```json
{
  "success": true,
  "message": "Queryå·²å‘é€åˆ°Manuså¹³å°",
  "query": "ç›®å‰çš„å€‰çš„æª”æ¡ˆæ•¸é‡æ˜¯å¤šå°‘",
  "enhanced_query": "ç›®å‰çš„å€‰çš„æª”æ¡ˆæ•¸é‡æ˜¯å¤šå°‘ (ä»“åº“: alexchuang650730/aicore0624, åˆ†æ”¯: main)",
  "manus_message": "æŸ¥è¯¢: ç›®å‰çš„å€‰çš„æª”æ¡ˆæ•¸é‡æ˜¯å¤šå°‘ (ä»“åº“: alexchuang650730/aicore0624, åˆ†æ”¯: main)\næ£€æµ‹åˆ°éœ€è¦ä»“åº“æ•°æ®ï¼Œä½†é¡¹ç›®ä¸­å°šæœªåŒ…å«ä»“åº“ alexchuang650730/aicore0624ã€‚\nè¯·æ‰§è¡Œ: git clone https://github.com/alexchuang650730/aicore0624.git\nç„¶ååˆ†æä»“åº“æ–‡ä»¶æ•°é‡å¹¶å›åº”æŸ¥è¯¢ã€‚",
  "repository_info": {
    "name": "alexchuang650730/aicore0624",
    "url": "https://github.com/alexchuang650730/aicore0624.git",
    "branch": "main"
  },
  "git_clone_requested": true,
  "timestamp": "2025-06-28T22:33:23.781682"
}
```

---

## ğŸ’¡ **æ ¸å¿ƒä»·å€¼**

### 1. **ä»è¢«åŠ¨åˆ°ä¸»åŠ¨**
- âŒ ä¿®å¤å‰ï¼šè¢«åŠ¨è½¬å‘æŸ¥è¯¢
- âœ… ä¿®å¤åï¼šä¸»åŠ¨åˆ†æå’Œå¤„ç†æŸ¥è¯¢

### 2. **ä»ç®€å•åˆ°æ™ºèƒ½**
- âŒ ä¿®å¤å‰ï¼šç®€å•å­—ç¬¦ä¸²å¤„ç†
- âœ… ä¿®å¤åï¼šæ™ºèƒ½è¯­ä¹‰åˆ†æå’Œä¸Šä¸‹æ–‡å¢å¼º

### 3. **ä»å•ä¸€åˆ°å®Œæ•´**
- âŒ ä¿®å¤å‰ï¼šåªå‘é€æŸ¥è¯¢
- âœ… ä¿®å¤åï¼šå‘é€æŸ¥è¯¢ + ä»“åº“ä¿¡æ¯ + æ“ä½œæŒ‡ä»¤

### 4. **ä»æ¨¡æ‹Ÿåˆ°å®ç”¨**
- âŒ ä¿®å¤å‰ï¼šæ¨¡æ‹Ÿå‘é€ï¼Œæ— å®é™…ä½œç”¨
- âœ… ä¿®å¤åï¼šçœŸå®çš„git cloneè¯·æ±‚ï¼Œæœ‰å®é™…æ“ä½œä»·å€¼

---

## ğŸ¯ **æ€»ç»“**

**send_messageä¿®å¤çš„æ ¸å¿ƒ**ï¼š
1. **æ™ºèƒ½åŒ–**ï¼šä»ç®€å•è½¬å‘å˜ä¸ºæ™ºèƒ½åˆ†æå¤„ç†
2. **è‡ªåŠ¨åŒ–**ï¼šè‡ªåŠ¨æ£€æµ‹ã€å¢å¼ºã€ç”Ÿæˆæ“ä½œæŒ‡ä»¤
3. **å®ç”¨åŒ–**ï¼šä»æ¨¡æ‹Ÿå˜ä¸ºçœŸå®çš„git cloneè¯·æ±‚
4. **å®Œæ•´åŒ–**ï¼šæä¾›å®Œæ•´çš„ä¸Šä¸‹æ–‡å’Œæ“ä½œæŒ‡å¯¼

**å®é™…ä½œç”¨**ï¼šç°åœ¨å½“ç”¨æˆ·è¯¢é—®ä»“åº“ä¿¡æ¯æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ã€å¢å¼ºæŸ¥è¯¢ã€å¹¶è¯·æ±‚Manusæ‰§è¡Œgit cloneæ¥è·å–æœ€æ–°æ•°æ®ï¼ŒçœŸæ­£å®ç°äº†æ™ºèƒ½åŒ–çš„ä»“åº“ç®¡ç†å’Œæ•°æ®åŒæ­¥ã€‚

